@page
@using Knowledtree.Web.Pages
@using Volo.Abp.Users
@model IndexModel
@inject ICurrentUser CurrentUser

@if (!CurrentUser.IsAuthenticated)
{
    <div class="row align-items-center justify-content-center" style="min-height: 60vh;">
        <div class="col-md-8 text-center">
            <h1 class="display-3 fw-bold text-primary mb-4">Knowledtree</h1>
            <p class="lead text-muted mb-5">
                The content management platform that grows with your organization. 
                <br>Secure, scalable, and modular.
            </p>
            <a href="/Account/Login" class="btn btn-primary btn-lg px-5 py-3 rounded-pill shadow-sm">
                <i class="fa fa-sign-in-alt me-2"></i> Access Dashboard
            </a>
            <div class="mt-5 text-muted small">
                Powered by PRO-CODE agent (ABP Framework v9 + PostgreSQL)
            </div>
        </div>
    </div>
}
else
{
    <div class="fade-in">
        <div class="d-flex justify-content-between align-items-center mb-5 border-bottom pb-3">
            <div>
                <h2 class="fw-bold mb-1 text-dark">Management Dashboard</h2>
                <p class="text-muted mb-0">Overview of your system status</p>
            </div>
            <div>
                 <span class="badge bg-light text-dark border p-2">
                    <i class="fa fa-user-circle me-1"></i> @CurrentUser.UserName
                 </span>
            </div>
        </div>

        <div class="row g-4">
            <!-- User Stats Card -->
            <div class="col-md-6 col-lg-3">
                <div class="card h-100 border-0 shadow-sm hover-shadow transition-all">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="rounded-3 bg-primary bg-opacity-10 p-3 text-primary me-3">
                                <i class="fa fa-users fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="card-subtitle text-muted mb-1 font-weight-bold">Total Users</h6>
                                <h3 class="card-title mb-0 display-6">@Model.UserCount</h3>
                            </div>
                        </div>
                        <a href="/Identity/Users" class="btn btn-sm btn-outline-primary w-100 stretched-link">
                            Manage Users <i class="fa fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>

             <!-- Roles Card -->
            <div class="col-md-6 col-lg-3">
                <div class="card h-100 border-0 shadow-sm hover-shadow transition-all">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="rounded-3 bg-success bg-opacity-10 p-3 text-success me-3">
                                <i class="fa fa-user-shield fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="card-subtitle text-muted mb-1 font-weight-bold">Roles</h6>
                                <h3 class="card-title mb-0">Config</h3>
                            </div>
                        </div>
                        <a href="/Identity/Roles" class="btn btn-sm btn-outline-success w-100 stretched-link">
                            Manage Roles <i class="fa fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>

             <!-- Tenants Card -->
             <div class="col-md-6 col-lg-3">
                <div class="card h-100 border-0 shadow-sm hover-shadow transition-all">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="rounded-3 bg-warning bg-opacity-10 p-3 text-warning me-3">
                                <i class="fa fa-building fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="card-subtitle text-muted mb-1 font-weight-bold">Tenants</h6>
                                <h3 class="card-title mb-0">SaaS</h3>
                            </div>
                        </div>
                        <a href="/TenantManagement/Tenants" class="btn btn-sm btn-outline-warning w-100 stretched-link">
                            Manage Tenants <i class="fa fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Settings Card -->
            <div class="col-md-6 col-lg-3">
                <div class="card h-100 border-0 shadow-sm hover-shadow transition-all">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="rounded-3 bg-secondary bg-opacity-10 p-3 text-secondary me-3">
                                <i class="fa fa-cogs fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="card-subtitle text-muted mb-1 font-weight-bold">Settings</h6>
                                <h3 class="card-title mb-0">System</h3>
                            </div>
                        </div>
                         <!-- Note: Setting management link might check permissions, using generic link for dashboard -->
                        <a href="/SettingManagement" class="btn btn-sm btn-outline-secondary w-100 stretched-link">
                            View Settings <i class="fa fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
            
        </div>
        
        <div class="row mt-5">
            <div class="col-12">
                 <div class="alert alert-info border-0 bg-info bg-opacity-10 text-info">
                    <i class="fa fa-info-circle me-2"></i>
                    <strong>System Ready:</strong> You can start building your "Knowledge Tree" modules. The infrastructure is fully operational.
                </div>
            </div>
        </div>
    </div>
}

<style>
    .hover-shadow:hover {
        transform: translateY(-5px);
        box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important;
    }
    .transition-all {
        transition: all 0.3s ease;
    }
</style>
